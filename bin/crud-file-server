#!/usr/bin/env node

var argv = require('optimist').argv;
var server = require('../crud-file-server');

if(argv.h) {
	console.log('usage: crud-file-server [options]');
	console.log('');
	console.log('starts a subproxy server using the specified command-line options');
	console.log('(if you run with localhost, make sure to modify your hosts file!)');
	console.log('');
	console.log('options:');
	console.log('	-f: file system path to expose over http');
	console.log('	-p: port to listen on (example, 80)');
	console.log('	-h: this help message');
} else {
	var port = argv.p || 80;
	var path = argv.f || __dirname;

	require('http').createServer(function (req, res) {
		server.handleRequest(port, path, req, res);
	}).listen(port);
	
	console.log('listening on port ' + port + ', serving directory ' + path);
}
